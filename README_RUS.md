### IntentClasiifier
библиотека предобученных алгоритмов для классификации намерений человека при общении человека с чат ботом. Библиотека была разработана в рамках проекта на зимней школе CompTech@NSK в Новосибирске, 2019. Идея проекта была сформулирована компанией DataMonsters.
 Задачи бибилиотеки:
 * выполнять классификацию русскоязычных намерений (intents) с высокой точностью и за малое времи;
 * выполнять дообучение на новом датасете;
 

## Возможности для использования:
Предобученную модель можно использовать для реализации чат-ботов мобильных операторов при общении с клиентом. 
Разработануную в рамках текущего проекта можно дообучить на новых данных для решения следующих бизнес-задач:
* реализация чат-ботов на любую тематику (заказ покупок на дом, консультация по выдаче кредитов, общение с клиентом для возврата просроченной задолженности и т.п.);
* классификации заголовков газет, рекламы;
* автоматическая классификация сообщений в почтовом ящике;
* реализации советчика при выборе фильма, книги, еды, места и т.п;
* и прочие.

На основе текущей версии библиотеки реализован чат-бот на базе платформы ВКонтакте для общения с клиентом на тему услуг, предоставляемых мобильными операторами. Размеченные данные для обучения модели предоставлены компанией Data Monsters и включают реальные переговоры пользователей из общения с оператором.

 ## Структура библиотеки
 В библиотеке представленны следующие алгоритмы машинного обучения. 
* 
* 
* 
* 
* 
* 
Модель была разработана специально для работы с небольшими обучающими датасетами из небольших текстов.
Каждый из алгоритмов был предобучен на датасете состоящем из русскоязычных обращения пользователя к чат-боту мобильного оператора. Датасет разделен на 10 классов и состоит 877 выражений.

Оценка качества алгоритмов проводилось с использование кросс-валидации на 10 блоках. Подробные результаты тестирования с описанием алгоритмов представлены в документе [Test Results](https://github.com/CompTech-IntentClassifier/IntentClassifier/blob/master/Test%20Results.md). Все реализованные алгоритмы показали хорошее качество классификации с выше 89% (Критерием качества является сбалансированная F-мера).

## Возможности библиотеки

# Готовый классификатор намерений для общения клиента с чат-ботом мобильного оператора:
Пользователь может использовать готовую модель для классификации намерений. Для этого используется вызов метода predict(), в котором на вход подается выражение X строкового типа.
*predict(self, X)

# Выбор наилучшего алгоритма.
Пользователь может сравнить результаты работы всех предложенных алгоритмов на своём датасете и выбрать наилучший.

# Дообучение:
Пользователь может адаптировать каждый из реализованных алгоритмов для своих задач.
*fit(self, X, Y, **kwargs)

Для адаптации готового алгоритма на вход нужно подать размеченный датасет, где X - набор выражений, Y - соответствующие им классы.

## Установка библиотеки
Прежде чем использовать библиотеку IntentClassifier убедитесь, что у вас установлен Python 3.x (мы использовали версию Python 3.6).
Выполните команду для установки всех необходимых пакетов (все необходимые пакеты перечислены в файле requirements.txt):
```
pip install -r requirements.txt
```
Кроме того, требуется скачать предобученную модель spacy xx_ent_wiki_sm. Сделать это можно с помощью команды:

Для установки пакета IntentClassifier выполните команду
```
git clone https://github.com/CompTech-IntentClassifier/IntentClassifier.git
cd IntentClassifier
sudo python setup.py
```

Чтобы ознакомиться с возможностями библиотеки запустите тесты, выполнив следующую команду
```
python setup.py test
```

## Примеры использования

1. Использование классификатора на основе многоязычного Bert.
```
from IntentClassifier import BertClf
model = BertClf()
sentence = "Жду ответа оператора"
class = model.predict(sentence)
```
2. Чтобы дообучить классификатор на своих данных и использовать новую модель используйте метод fit() куда подается размеченный датасет в виде словаря состоящего из пар <класс | выражение>
```
from IntentClassifier import BertClf
dataset = read_csv("newdataset.csv")
sentences = dataset['texts']
classes = dataset['classes']

model = BertClf()
model.fit(sentences, classes)
sentence = "Жду ответа оператора"
class = model.predict(sentence)
```
